import pandas as pd


def intersection(d1, d2):
    df1 = pd.read_csv(d1, index_col=0, sep=',')
    df2 = pd.read_csv(d2, index_col=0, sep=',')
    s1 = pd.merge(df1, df2, how='inner', on=['compound'])

    s1.to_csv('X:/MCES/compare/diff.csv')
    print(df1.shape[0])
    print(df2.shape[0])
    print('intersection is ', s1.shape[0])


# ------------------------------------------------------------------------------------------------------- #
#  _____                                           _       _____ _             _     _   _                #
# /  __ \                                         | |     /  ___| |           | |   | | | |               #
# | /  \/ ___  _ __ ___  _ __ ___   __ _ _ __   __| |___  \ `--.| |_ __ _ _ __| |_  | |_| | ___ _ __ ___  #
# | |    / _ \| '_ ` _ \| '_ ` _ \ / _` | '_ \ / _` / __|  `--. \ __/ _` | '__| __| |  _  |/ _ \ '__/ _ \ #
# | \__/\ (_) | | | | | | | | | | | (_| | | | | (_| \__ \ /\__/ / || (_| | |  | |_  | | | |  __/ | |  __/ #
#  \____/\___/|_| |_| |_|_| |_| |_|\__,_|_| |_|\__,_|___/ \____/ \__\__,_|_|   \__| \_| |_/\___|_|  \___| #
#                                                                                                         #
# ------------------------------------------------------------------------------------------------------- #



dat1 = 'X:/MCES/compare/AF_before_run.csv'
dat2 = 'X:/MCES/compare/MP_before_run.csv'

intersection(dat1, dat2)
